<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sebuah Kejutan Untukmu!</title>
    <!-- Memuat Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Memuat Font Kustom dari Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <!-- Memuat Ikon (untuk Navigasi & Tombol Mute) -->
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

    <style>
        /* CSS Kustom */
        body {
            background-image: url('https://feeldreams.github.io/wp11.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            font-family: 'Inter', sans-serif;
            padding-bottom: 80px; 
        }

        .font-display {
            font-family: 'Fredoka One', cursive;
        }

        .shadow-text {
            text-shadow: 0px 2px 4px rgba(0, 0, 0, 0.5);
        }

        /* Animasi */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }

        /* Navigasi Bawah */
        .nav-bar {
            box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.1);
        }
        .nav-button {
            transition: all 0.2s ease;
        }
        .nav-button.active {
            color: #ec4899; /* pink-500 */
            transform: scale(1.1);
        }

        /* Modal Styling */
        .modal {
            display: none; /* Diubah oleh JS */
        }
        .modal-content {
            max-height: 90vh;
            overflow-y: auto; /* PERBAIKAN: Menjamin bisa scroll di layar kecil */
        }

        /* Game Cilukba */
        .game-cell {
            display: flex; /* PERBAIKAN: Untuk memusatkan emoji fallback */
            align-items: center;
            justify-content: center;
        }
        .game-cell:hover {
            transform: scale(1.05);
        }
        .mole {
            animation: popUp 0.3s ease;
        }
        @keyframes popUp {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        /* Game Memory Match */
        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.5rem;
        }
        .memory-card {
            width: 100%;
            padding-top: 100%; /* Membuat kartu jadi kotak */
            position: relative;
            cursor: pointer;
            transform-style: preserve-3d;
            transition: transform 0.4s ease;
        }
        .memory-card .card-face {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.5rem;
            backface-visibility: hidden;
        }
        .card-front {
            background-color: #60a5fa; /* blue-400 */
        }
        .card-back {
            background-color: #f3f4f6; /* gray-100 */
            transform: rotateY(180deg);
            font-size: 2.5rem; /* Ukuran emoji */
        }
        .memory-card.is-flipped {
            transform: rotateY(180deg);
        }
        .memory-card.is-matched {
            pointer-events: none;
            opacity: 0.5;
        }
        
        /* Game Kertas Gunting Batu (KGB) */
        .kgb-choice {
            transition: all 0.2s ease;
        }
        .kgb-choice:hover {
            transform: scale(1.1);
            filter: drop-shadow(0 4px 10px rgba(0,0,0,0.3));
        }
        
        /* Animasi untuk hasil KGB */
        @keyframes resultPop {
            0% { transform: scale(0.5); opacity: 0; }
            70% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); }
        }
        .result-pop {
            animation: resultPop 0.4s ease-out;
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Musik Latar (Autoplay) -->
    <audio id="bgMusic" src="https://files.catbox.moe/7czehh.mp3" loop autoplay></audio>

    <!-- 
      LAYAR 1: MODAL NAMA PENGGUNA
    -->
    <div id="nameModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4">
        <div class="bg-white bg-opacity-90 backdrop-blur-sm p-8 rounded-2xl shadow-2xl text-center w-full max-w-md animate-fade-in">
            <!-- PERBAIKAN: Menambahkan fallback onerror -->
            <img src="https://feeldreams.github.io/pandapanah.gif" alt="Panda lucu" class="w-32 h-32 mx-auto mb-4 rounded-full shadow-lg" 
                 onerror="this.outerHTML = '<div class=\'w-32 h-32 mx-auto mb-4 flex items-center justify-center bg-gray-200 rounded-full text-5xl\'>üêº</div>'">
            <h2 class="text-3xl font-display text-pink-600 mb-2">Halo, Kamu!</h2>
            <p class="text-lg mb-4">Sebelum kita mulai seru-seruan, boleh tulis nama panggilanmu dulu?</p>
            <input type="text" id="nameInput" class="w-full px-4 py-3 border-2 border-pink-300 rounded-xl text-lg text-center focus:outline-none focus:ring-2 focus:ring-pink-500" placeholder="Tulis namamu di sini...">
            <p id="nameError" class="text-red-500 text-sm mt-2 hidden">Nama nggak boleh kosong ya!</p>
            <button id="startButton" class="w-full mt-4 bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-6 rounded-xl text-lg transition-all transform hover:scale-105 shadow-lg">
                Lanjut!
            </button>
        </div>
    </div>

    <!-- 
      KONTEN UTAMA
    -->
    <div id="mainContent" class="hidden min-h-screen w-full p-4 md:p-8 flex flex-col items-center">

        <!-- HALAMAN 1: BERANDA (Default) -->
        <div id="page-home" class="w-full max-w-lg animate-fade-in">
            <div class="text-center p-6 bg-white bg-opacity-80 backdrop-blur-sm rounded-2xl shadow-xl">
                <h1 class="text-4xl md:text-5xl font-display text-pink-600 shadow-text">
                    Hai, <span class="userNameDisplay text-yellow-500">Kamu</span>!
                </h1>
                <p class="text-xl text-gray-700 mt-2">Selamat datang di hadiah spesial ini!</p>
                <!-- PERBAIKAN: Menambahkan fallback onerror -->
                <img src="https://feeldreams.github.io/weee.gif" alt="Stiker weee" class="w-40 h-40 mx-auto mt-4" 
                     onerror="this.outerHTML = '<div class=\'w-40 h-40 mx-auto mt-4 flex items-center justify-center bg-gray-200 rounded-lg text-gray-500\'>[Stiker Lucu]</div>'">
                <p class="text-lg mt-4">Aku udah siapin beberapa game dan kejutan kecil buatmu. Cek "Zona Game" atau "Zona Santai" di bawah ya!</p>
            </div>
        </div>

        <!-- HALAMAN 2: ZONA GAME (Hidden) -->
        <div id="page-games" class="w-full max-w-lg animate-fade-in hidden space-y-6">
            <h1 class="text-4xl font-display text-white shadow-text text-center">Zona Game</h1>
            
            <!-- Tombol Game Kertas Gunting Batu -->
            <div class="bg-white bg-opacity-90 backdrop-blur-sm p-6 rounded-2xl shadow-xl text-center">
                <h3 class="text-2xl font-display text-green-600 mb-3">Game: Kertas Gunting Batu!</h3>
                <p class="mb-4">Ayo adu suit lawan komputer. Siapa yang bakal menang? ü™®‚úÇÔ∏èüìÑ</p>
                <button id="launchKGB" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-5 rounded-xl text-lg transition-all transform hover:scale-105 shadow-md">
                    Mulai Main Suit!
                </button>
            </div>

            <!-- Tombol Game Cilukba -->
            <div class="bg-white bg-opacity-90 backdrop-blur-sm p-6 rounded-2xl shadow-xl text-center">
                <h3 class="text-2xl font-display text-purple-600 mb-3">Game: Cilukba Cepat!</h3>
                <p class="mb-4">Tes seberapa cepat reaksimu! Klik gambar yang muncul secepat mungkin.</p>
                <button id="launchCilukba" class="w-full bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-5 rounded-xl text-lg transition-all transform hover:scale-105 shadow-md">
                    Mulai Main Cilukba!
                </button>
            </div>

            <!-- Tombol Game Memory Match -->
            <div class="bg-white bg-opacity-90 backdrop-blur-sm p-6 rounded-2xl shadow-xl text-center">
                <h3 class="text-2xl font-display text-blue-600 mb-3">Game: Memory Match!</h3>
                <p class="mb-4">Cari pasangan kartu emoji yang sama. Uji ingatanmu!</p>
                <button id="launchMemory" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-5 rounded-xl text-lg transition-all transform hover:scale-105 shadow-md">
                    Mulai Main Memory!
                </button>
            </div>
        </div>

        <!-- HALAMAN 3: ZONA SANTAI (Hidden) -->
        <div id="page-fun" class="w-full max-w-lg animate-fade-in hidden space-y-6">
            <h1 class="text-4xl font-display text-white shadow-text text-center">Zona Santai</h1>

            <!-- Tombol Generator Semangat -->
            <div class="bg-white bg-opacity-90 backdrop-blur-sm p-6 rounded-2xl shadow-xl text-center">
                <h3 class="text-2xl font-display text-yellow-600 mb-3">Butuh Semangat?</h3>
                <p class="mb-4">Klik di sini buat dapetin kutipan penyemangat acak. GRATIS!</p>
                <button id="launchQuote" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 px-5 rounded-xl text-lg transition-all transform hover:scale-105 shadow-md">
                    Kasih Aku Semangat!
                </button>
            </div>

            <!-- Tombol Reward / Virtual Hug -->
            <div class="bg-white bg-opacity-90 backdrop-blur-sm p-6 rounded-2xl shadow-xl text-center">
                <h3 class="text-2xl font-display text-teal-600 mb-3">Kejutan Spesial!</h3>
                <p class="mb-4">Klik di sini untuk dapet suntikan semangat instan (versi peluk)!</p>
                <button id="rewardButton" class="w-full bg-teal-500 hover:bg-teal-600 text-white font-bold py-3 px-5 rounded-xl text-lg transition-all transform hover:scale-105 shadow-md">
                    Klik Buat Kejutan!
                </button>
            </div>

            <!-- Fitur Tanya Kerang Ajaib -->
            <div class="bg-white bg-opacity-90 backdrop-blur-sm p-6 rounded-2xl shadow-xl text-center">
                <h3 class="text-2xl font-display text-orange-600 mb-3">Tanya Kerang Ajaib!</h3>
                <p class="mb-4">Punya pertanyaan (Ya/Tidak)? Tanyakan pada kerang ajaib!</p>
                <button id="launchMagicShell" class="w-full bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-5 rounded-xl text-lg transition-all transform hover:scale-105 shadow-md">
                    Tanya Sekarang!
                </button>
            </div>
        </div>
    </div>

    <!-- 
      NAVIGASI BAWAH
    -->
    <footer id="navBar" class="nav-bar hidden fixed bottom-0 left-0 w-full bg-white bg-opacity-90 backdrop-blur-sm flex justify-around p-3 z-30">
        <button id="nav-home" class="nav-button active flex flex-col items-center text-gray-600" data-page="page-home">
            <ion-icon name="home-outline" class="text-3xl"></ion-icon>
            <span class="text-xs">Beranda</span>
        </button>
        <button id="nav-games" class="nav-button flex flex-col items-center text-gray-600" data-page="page-games">
            <ion-icon name="game-controller-outline" class="text-3xl"></ion-icon>
            <span class="text-xs">Zona Game</span>
        </button>
        <button id="nav-fun" class="nav-button flex flex-col items-center text-gray-600" data-page="page-fun">
            <ion-icon name="sparkles-outline" class="text-3xl"></ion-icon>
            <span class="text-xs">Zona Santai</span>
        </button>
    </footer>

    <!-- 
      TOMBOL MUTE (FITUR BARU)
    -->
    <button id="muteButton" class="hidden fixed top-4 right-4 z-50 bg-white bg-opacity-70 backdrop-blur-sm text-pink-500 p-2 rounded-full shadow-md text-2xl">
        <ion-icon name="volume-high-outline"></ion-icon>
    </button>


    <!-- 
      MODAL-MODAL
      (Pop-up untuk game dan kejutan)
    -->

    <!-- Modal Reward (Virtual Hug) -->
    <div id="rewardModal" class="modal fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-40 p-4">
        <div class="modal-content bg-white bg-opacity-95 backdrop-blur-sm p-8 rounded-2xl shadow-2xl text-center w-full max-w-md animate-fade-in relative">
            <button class="close-modal-btn absolute top-3 right-4 text-gray-500 hover:text-gray-800 text-4xl font-bold">&times;</button>
            <!-- PERBAIKAN: Menambahkan fallback onerror -->
            <img src="https://feeldreams.github.io/emawh.gif" alt="Stiker peluk" class="w-40 h-40 mx-auto mb-4 rounded-lg" 
                 onerror="this.outerHTML = '<div class=\'w-40 h-40 mx-auto mb-4 flex items-center justify-center bg-gray-200 rounded-lg text-5xl\'>ü§ó</div>'">
            <h2 class="text-3xl font-display text-teal-600 mb-2">TADAAAAA!</h2>
            <p class="text-lg mb-4">
                Ini dia <i>virtual hug</i> dan suntikan semangat spesial buat 
                <span class="userNameDisplay font-bold">kamu</span>! 
                Semoga harimu makin seru dan menyenangkan ya! üòâ
            </p>
        </div>
    </div>

    <!-- Modal Kerang Ajaib -->
    <div id="magicShellModal" class="modal fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-40 p-4">
        <div class="modal-content bg-white bg-opacity-95 backdrop-blur-sm p-8 rounded-2xl shadow-2xl text-center w-full max-w-md animate-fade-in relative">
            <button class="close-modal-btn absolute top-3 right-4 text-gray-500 hover:text-gray-800 text-4xl font-bold">&times;</button>
            <h2 class="text-3xl font-display text-orange-600 mb-4">Kerang Ajaib Bilang...</h2>
            <input type="text" id="shellQuestion" class="w-full px-4 py-3 border-2 border-orange-300 rounded-xl text-lg text-center focus:outline-none focus:ring-2 focus:ring-orange-500" placeholder="Tulis pertanyaanmu...">
            <button id="askShellButton" class="w-full mt-4 bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-6 rounded-xl text-lg transition-all transform hover:scale-105 shadow-lg">
                Tanya!
            </button>
            <div id="shellAnswer" class="mt-6 text-2xl font-bold text-orange-800 h-12 flex items-center justify-center">
                <!-- Jawaban muncul di sini -->
            </div>
        </div>
    </div>

    <!-- Modal Generator Semangat -->
    <div id="quoteModal" class="modal fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-40 p-4">
        <div class="modal-content bg-white bg-opacity-95 backdrop-blur-sm p-8 rounded-2xl shadow-2xl text-center w-full max-w-md animate-fade-in relative">
            <button class="close-modal-btn absolute top-3 right-4 text-gray-500 hover:text-gray-800 text-4xl font-bold">&times;</button>
            <!-- PERBAIKAN: Menambahkan fallback onerror -->
            <img src="https://feeldreams.github.io/pandapanah.gif" alt="Panda semangat" class="w-32 h-32 mx-auto mb-4 rounded-full shadow-lg" 
                 onerror="this.outerHTML = '<div class=\'w-32 h-32 mx-auto mb-4 flex items-center justify-center bg-gray-200 rounded-full text-5xl\'>üêº</div>'">
            <h2 class="text-3xl font-display text-yellow-600 mb-4">Suntikan Semangat!</h2>
            <div class="min-h-[100px] flex items-center justify-center p-4 bg-yellow-50 rounded-lg">
                <p id="quoteDisplay" class="text-xl italic text-yellow-800">"..."</p>
            </div>
            <button id="newQuoteButton" class="w-full mt-6 bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 px-6 rounded-xl text-lg transition-all transform hover:scale-105 shadow-lg">
                Ganti Kutipan
            </button>
        </div>
    </div>

    <!-- Modal Game Cilukba -->
    <div id="cilukbaModal" class="modal fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-40 p-4">
        <div class="modal-content bg-white bg-opacity-95 backdrop-blur-sm p-6 rounded-2xl shadow-2xl w-full max-w-lg animate-fade-in relative">
            <button class="close-modal-btn absolute top-3 right-4 text-gray-500 hover:text-gray-800 text-4xl font-bold">&times;</button>
            <h3 class="text-2xl font-display text-purple-600 mb-3 text-center">Game: Cilukba Cepat!</h3>
            <div class="flex justify-between items-center mb-4 px-4">
                <span class="text-xl font-bold">Skor: <span id="gameScore" class="text-purple-700">0</span></span>
                <button id="startGameButton" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-5 rounded-full text-lg transition-all transform hover:scale-105 shadow-md">
                    Mulai Main!
                </button>
            </div>
            <div id="gameGrid" class="grid grid-cols-3 gap-3 p-2 bg-purple-100 rounded-lg">
                <!-- Sel game akan dibuat oleh JavaScript -->
            </div>
        </div>
    </div>
    
    <!-- Modal Game Memory Match -->
    <div id="memoryModal" class="modal fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-40 p-4">
        <div class="modal-content bg-white bg-opacity-95 backdrop-blur-sm p-6 rounded-2xl shadow-2xl w-full max-w-lg animate-fade-in relative">
            <button class="close-modal-btn absolute top-3 right-4 text-gray-500 hover:text-gray-800 text-4xl font-bold">&times;</button>
            <h3 class="text-2xl font-display text-blue-600 mb-3 text-center">Game: Memory Match!</h3>
            <div class="flex justify-between items-center mb-4 px-2">
                <span class="text-lg font-bold">Langkah: <span id="memoryMoves" class="text-blue-700">0</span></span>
                <button id="restartMemoryButton" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-full text-sm transition-all shadow-md">
                    Mulai Ulang
                </button>
            </div>
            <div id="memoryGrid" class="memory-grid">
                <!-- Kartu memory akan dibuat oleh JavaScript -->
            </div>
            <div id="memoryWinMessage" class="hidden text-center mt-4 p-4 bg-blue-100 rounded-lg">
                <h4 class="text-2xl font-display text-blue-800">KEREN!</h4>
                <p class="text-lg">Kamu menang dengan <span id="memoryFinalMoves">0</span> langkah!</p>
            </div>
        </div>
    </div>
    
    <!-- Modal Game Kertas Gunting Batu -->
    <div id="kgbModal" class="modal fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-40 p-4">
        <div class="modal-content bg-white bg-opacity-95 backdrop-blur-sm p-6 rounded-2xl shadow-2xl w-full max-w-lg animate-fade-in relative">
            <button class="close-modal-btn absolute top-3 right-4 text-gray-500 hover:text-gray-800 text-4xl font-bold">&times;</button>
            <h3 class="text-2xl font-display text-green-600 mb-4 text-center">Game: Kertas Gunting Batu!</h3>
            
            <!-- Papan Skor -->
            <div class="flex justify-around items-center text-center mb-4 p-4 bg-green-50 rounded-lg">
                <div>
                    <div class="text-lg font-bold text-green-700"><span class="userNameDisplay">Kamu</span></div>
                    <div id="kgbPlayerScore" class="text-4xl font-display">0</div>
                </div>
                <div class="text-2xl font-bold text-gray-500">VS</div>
                <div>
                    <div class="text-lg font-bold text-green-700">Komputer</div>
                    <div id="kgbCompScore" class="text-4xl font-display">0</div>
                </div>
            </div>

            <!-- Area Hasil -->
            <div class="flex justify-around items-center text-center mb-6 min-h-[80px]">
                <div id="kgbPlayerChoice" class="text-5xl">?</div>
                <div id="kgbResultText" class="text-2xl font-bold text-green-800 w-1/3">Pilih Jagoanmu!</div>
                <div id="kgbCompChoice" class="text-5xl">?</div>
            </div>

            <!-- Tombol Pilihan -->
            <div class="flex justify-around items-center text-center">
                <button data-choice="batu" class="kgb-choice text-6xl p-4 bg-gray-200 rounded-full shadow-md">ü™®</button>
                <button data-choice="gunting" class="kgb-choice text-6xl p-4 bg-gray-200 rounded-full shadow-md">‚úÇÔ∏è</button>
                <button data-choice="kertas" class="kgb-choice text-6xl p-4 bg-gray-200 rounded-full shadow-md">üìÑ</button>
            </div>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- Variabel Global ---
            const nameModal = document.getElementById('nameModal');
            const mainContent = document.getElementById('mainContent');
            const navBar = document.getElementById('navBar');
            const startButton = document.getElementById('startButton');
            const nameInput = document.getElementById('nameInput');
            const nameError = document.getElementById('nameError');
            const userNameDisplays = document.querySelectorAll('.userNameDisplay');
            const bgMusic = document.getElementById('bgMusic');
            let userName = "Kamu";
            
            // Variabel Tombol Mute (FITUR BARU)
            const muteButton = document.getElementById('muteButton');
            const muteIcon = muteButton.querySelector('ion-icon');
            let isMuted = true; // Asumsikan audio mati di awal

            // --- Logika Halaman Utama (Nama & Navigasi) ---

            // 1. Logika Tombol Mulai (Modal Nama)
            startButton.addEventListener('click', () => {
                userName = nameInput.value.trim();
                
                if (userName === "") {
                    nameError.classList.remove('hidden');
                } else {
                    nameError.classList.add('hidden');
                    userNameDisplays.forEach(span => {
                        span.textContent = userName;
                    });
                    
                    // Sembunyikan semua modal lain (Perbaikan Bug v4)
                    document.querySelectorAll('.modal').forEach(modal => {
                        modal.style.display = 'none';
                    });
                    
                    nameModal.style.display = 'none'; 
                    mainContent.classList.remove('hidden'); 
                    navBar.classList.remove('hidden'); 
                    muteButton.classList.remove('hidden'); // Tampilkan tombol mute
                    document.body.style.overflow = 'auto';
                    
                    // Set halaman utama (beranda) sebagai yang aktif
                    document.querySelectorAll('#mainContent > div[id^="page-"]').forEach(page => page.classList.add('hidden'));
                    document.getElementById('page-home').classList.remove('hidden');
                    document.querySelectorAll('.nav-button').forEach(btn => btn.classList.remove('active'));
                    document.getElementById('nav-home').classList.add('active');

                    // Coba putar musik dan update ikon mute
                    bgMusic.play().then(() => {
                        isMuted = false;
                        muteIcon.setAttribute('name', 'volume-high-outline');
                    }).catch(e => {
                        console.warn("Autoplay gagal, audio di-mute.");
                        isMuted = true;
                        muteIcon.setAttribute('name', 'volume-mute-outline');
                    });
                }
            });

            // 2. Logika Navigasi Halaman
            const navButtons = document.querySelectorAll('.nav-button');
            const pages = document.querySelectorAll('#mainContent > div[id^="page-"]');

            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const pageId = button.dataset.page;
                    pages.forEach(page => page.classList.add('hidden'));
                    document.getElementById(pageId).classList.remove('hidden');
                    navButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                });
            });

            // 3. Logika Modal
            const allModals = document.querySelectorAll('.modal');
            const allCloseButtons = document.querySelectorAll('.close-modal-btn');

            function openModal(modal) {
                modal.style.display = 'flex';
            }

            function closeModal(modal) {
                modal.style.display = 'none';
            }
            
            allCloseButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const modal = e.target.closest('.modal');
                    
                    // PERBAIKAN: Hentikan game jika modalnya ditutup
                    if (modal.id === 'cilukbaModal') {
                        endCilukbaGame(true); // 'true' berarti ditutup paksa
                    }
                    
                    closeModal(modal);
                });
            });
            
            // 4. Logika Tombol Mute (FITUR BARU)
            muteButton.addEventListener('click', () => {
                if (isMuted) {
                    bgMusic.play(); // Coba mainkan lagi
                    isMuted = false;
                    muteIcon.setAttribute('name', 'volume-high-outline');
                } else {
                    bgMusic.pause();
                    isMuted = true;
                    muteIcon.setAttribute('name', 'volume-mute-outline');
                }
            });

            // --- Logika "Zona Santai" ---

            // 5. Modal Reward (Virtual Hug)
            document.getElementById('rewardButton').addEventListener('click', () => {
                openModal(document.getElementById('rewardModal'));
            });

            // 6. Modal Kerang Ajaib
            const magicShellModal = document.getElementById('magicShellModal');
            const askShellButton = document.getElementById('askShellButton');
            const shellAnswer = document.getElementById('shellAnswer');
            const shellQuestion = document.getElementById('shellQuestion');
            const magicAnswers = [
                "Pasti dong!", "Tentu saja!", "Yakin 100%!", "Sudah jelas!",
                "Kayaknya sih...", "Bisa jadi...", "Hmm, mungkin...", "50:50",
                "Tanya lagi deh.", "Nggak yakin.", "Coba tanya hatimu.",
                "Mustahil!", "Nggak mungkin.", "Jangan harap.", "Jelas tidak."
            ];

            document.getElementById('launchMagicShell').addEventListener('click', () => {
                shellQuestion.value = '';
                shellAnswer.textContent = '';
                openModal(magicShellModal);
            });

            askShellButton.addEventListener('click', () => {
                if (shellQuestion.value.trim() === "") {
                    shellAnswer.textContent = "Tanya dulu dong!";
                    return;
                }
                
                shellAnswer.textContent = "Lagi mikir...";
                askShellButton.disabled = true;

                setTimeout(() => {
                    const randomIndex = Math.floor(Math.random() * magicAnswers.length);
                    shellAnswer.textContent = magicAnswers[randomIndex];
                    askShellButton.disabled = false;
                }, 1500);
            });

            // 7. Modal Generator Semangat
            const quoteModal = document.getElementById('quoteModal');
            const quoteDisplay = document.getElementById('quoteDisplay');
            const newQuoteButton = document.getElementById('newQuoteButton');
            const quotes = [
                "Jangan lupa senyum hari ini!",
                "Kamu lebih hebat dari yang kamu kira.",
                "Istirahat sejenak boleh, menyerah jangan.",
                "Satu langkah kecil lebih baik daripada tidak sama sekali.",
                "Bintang butuh gelap untuk bersinar.",
                "Percaya deh, semua bakal baik-baik aja.",
                "Setiap hari adalah kesempatan baru.",
                "Kamu keren. Udah, gitu aja.",
                "Kegagalan itu bumbu, bukan akhir cerita.",
                "Fokus sama progress, bukan kesempurnaan."
            ];

            function generateQuote() {
                const randomIndex = Math.floor(Math.random() * quotes.length);
                quoteDisplay.textContent = `"${quotes[randomIndex]}"`;
            }

            document.getElementById('launchQuote').addEventListener('click', () => {
                generateQuote(); 
                openModal(quoteModal);
            });
            newQuoteButton.addEventListener('click', generateQuote);


            // --- Logika "Zona Game" ---

            // 8. Game Cilukba Cepat
            const cilukbaModal = document.getElementById('cilukbaModal');
            const startGameButton = document.getElementById('startGameButton');
            const gameGrid = document.getElementById('gameGrid');
            const gameScore = document.getElementById('gameScore');
            let cilukbaScore = 0;
            let cilukbaActive = false;
            let cilukbaTimer;
            let gameCells = [];

            document.getElementById('launchCilukba').addEventListener('click', () => {
                openModal(cilukbaModal);
                resetCilukbaGrid(); 
            });

            startGameButton.addEventListener('click', startCilukbaGame);

            function startCilukbaGame() {
                if (cilukbaActive) return;
                cilukbaActive = true;
                cilukbaScore = 0;
                gameScore.textContent = cilukbaScore;
                startGameButton.disabled = true;
                startGameButton.textContent = "Tunggu...";

                resetCilukbaGrid();
                cilukbaTimer = setInterval(popMole, 900);
                setTimeout(() => endCilukbaGame(false), 15000); // Game 15 detik
            }

            function resetCilukbaGrid() {
                gameGrid.innerHTML = '';
                gameCells = [];
                for (let i = 0; i < 9; i++) {
                    const cell = document.createElement('div');
                    cell.className = "game-cell h-20 md:h-24 w-full bg-purple-200 rounded-lg cursor-pointer hover:bg-purple-300";
                    cell.addEventListener('click', whack);
                    gameGrid.appendChild(cell);
                    gameCells.push(cell);
                }
            }

            function whack(e) {
                // Pastikan targetnya adalah .game-cell, bukan gambar/emoji di dalamnya
                const targetCell = e.target.closest('.game-cell');
                if (!cilukbaActive || !targetCell || !targetCell.classList.contains('mole')) return;
                
                cilukbaScore++;
                gameScore.textContent = cilukbaScore;
                targetCell.classList.remove('mole');
                targetCell.innerHTML = '';
            }

            function popMole() {
                const currentMole = document.querySelector('.mole');
                if (currentMole) {
                    currentMole.classList.remove('mole');
                    currentMole.innerHTML = '';
                }
                const randomCell = gameCells[Math.floor(Math.random() * gameCells.length)];
                randomCell.classList.add('mole');
                
                // PERBAIKAN: Menambahkan fallback onerror yang lebih baik
                randomCell.innerHTML = `<img src="https://feeldreams.github.io/cilukba.gif" class="w-full h-full object-cover rounded-lg pointer-events-none" alt="Cilukba" 
                                             onerror="this.outerHTML = '<span class=\\'text-5xl md:text-6xl pointer-events-none animate-pulse\\'>üëª</span>'">`;
            }

            // PERBAIKAN: Fungsi untuk menghentikan game (timer)
            function endCilukbaGame(isForcedStop) {
                cilukbaActive = false;
                clearInterval(cilukbaTimer);
                startGameButton.disabled = false;
                startGameButton.textContent = "Mulai Main Lagi!";
                
                if (!isForcedStop) {
                    gameGrid.innerHTML = `<div class="col-span-3 text-center p-10 text-2xl font-display text-purple-800">Game Selesai!<br>Skor Akhir: ${cilukbaScore}</div>`;
                }
                // Jika dipaksa stop (isForcedStop = true), kita tidak tampilkan pesan "Game Selesai", biarkan resetGrid yg urus
            }
            
            // 9. Game Memory Match
            const memoryModal = document.getElementById('memoryModal');
            const memoryGrid = document.getElementById('memoryGrid');
            const memoryMovesEl = document.getElementById('memoryMoves');
            const memoryWinMessage = document.getElementById('memoryWinMessage');
            const memoryFinalMoves = document.getElementById('memoryFinalMoves');
            
            const emojis = ['üêº', '‚ù§Ô∏è', 'üåü', 'üéâ', 'üòÇ', 'üëç', 'üî•', 'üöÄ'];
            let memoryCards = [];
            let firstCard = null;
            let secondCard = null;
            let lockBoard = false;
            let moves = 0;

            document.getElementById('launchMemory').addEventListener('click', () => {
                openModal(memoryModal);
                startMemoryGame();
            });
            
            document.getElementById('restartMemoryButton').addEventListener('click', startMemoryGame);

            function startMemoryGame() {
                moves = 0;
                memoryMovesEl.textContent = moves;
                lockBoard = false;
                firstCard = null;
                secondCard = null;
                memoryWinMessage.classList.add('hidden');
                memoryGrid.innerHTML = '';
                memoryCards = [];

                let cardEmojis = [...emojis, ...emojis].sort(() => 0.5 - Math.random());
                
                cardEmojis.forEach(emoji => {
                    const card = document.createElement('div');
                    card.classList.add('memory-card');
                    card.dataset.emoji = emoji;
                    card.innerHTML = `
                        <div class="card-face card-front"></div>
                        <div class="card-face card-back">${emoji}</div>
                    `;
                    card.addEventListener('click', flipCard);
                    memoryGrid.appendChild(card);
                    memoryCards.push(card);
                });
            }

            function flipCard(e) {
                if (lockBoard) return;
                const clickedCard = e.currentTarget;
                if (clickedCard === firstCard) return; 
                clickedCard.classList.add('is-flipped');
                if (!firstCard) {
                    firstCard = clickedCard;
                    return;
                }
                secondCard = clickedCard;
                lockBoard = true;
                moves++;
                memoryMovesEl.textContent = moves;
                checkForMatch();
            }

            function checkForMatch() {
                let isMatch = firstCard.dataset.emoji === secondCard.dataset.emoji;
                isMatch ? disableCards() : unflipCards();
            }

            function disableCards() {
                firstCard.classList.add('is-matched');
                secondCard.classList.add('is-matched');
                checkWinCondition();
                resetBoard();
            }

            function unflipCards() {
                setTimeout(() => {
                    firstCard.classList.remove('is-flipped');
                    secondCard.classList.remove('is-flipped');
                    resetBoard();
                }, 1200);
            }

            function resetBoard() {
                [firstCard, secondCard, lockBoard] = [null, null, false];
            }
            
            function checkWinCondition() {
                const matchedCards = document.querySelectorAll('.memory-card.is-matched');
                if (matchedCards.length === memoryCards.length) {
                    setTimeout(() => {
                        memoryFinalMoves.textContent = moves;
                        memoryWinMessage.classList.remove('hidden');
                    }, 500);
                }
            }
            
            // 10. Game Kertas Gunting Batu
            const kgbModal = document.getElementById('kgbModal');
            const kgbPlayerScoreEl = document.getElementById('kgbPlayerScore');
            const kgbCompScoreEl = document.getElementById('kgbCompScore');
            const kgbPlayerChoiceEl = document.getElementById('kgbPlayerChoice');
            const kgbCompChoiceEl = document.getElementById('kgbCompChoice');
            const kgbResultTextEl = document.getElementById('kgbResultText');
            const kgbChoiceButtons = document.querySelectorAll('.kgb-choice');

            let kgbPlayerScore = 0;
            let kgbCompScore = 0;
            const kgbChoices = ['batu', 'gunting', 'kertas'];
            const kgbEmojis = { 'batu': 'ü™®', 'gunting': '‚úÇÔ∏è', 'kertas': 'üìÑ' };

            document.getElementById('launchKGB').addEventListener('click', () => {
                resetKGB();
                openModal(kgbModal);
            });

            function resetKGB() {
                kgbPlayerScore = 0;
                kgbCompScore = 0;
                kgbPlayerScoreEl.textContent = '0';
                kgbCompScoreEl.textContent = '0';
                kgbResultTextEl.textContent = 'Pilih Jagoanmu!';
                kgbPlayerChoiceEl.textContent = '?';
                kgbCompChoiceEl.textContent = '?';
            }

            kgbChoiceButtons.forEach(button => {
                button.addEventListener('click', () => {
                    playKGB(button.dataset.choice);
                });
            });

            function playKGB(playerChoice) {
                const computerChoice = kgbChoices[Math.floor(Math.random() * 3)];
                
                kgbPlayerChoiceEl.textContent = kgbEmojis[playerChoice];
                kgbCompChoiceEl.textContent = kgbEmojis[computerChoice];
                
                let result = '';
                if (playerChoice === computerChoice) {
                    result = "SERI!";
                    kgbResultTextEl.className = 'text-2xl font-bold text-gray-500 w-1/3 result-pop';
                } else if (
                    (playerChoice === 'batu' && computerChoice === 'gunting') ||
                    (playerChoice === 'gunting' && computerChoice === 'kertas') ||
                    (playerChoice === 'kertas' && computerChoice === 'batu')
                ) {
                    result = "KAMU MENANG!";
                    kgbPlayerScore++;
                    kgbPlayerScoreEl.textContent = kgbPlayerScore;
                    kgbResultTextEl.className = 'text-2xl font-bold text-green-600 w-1/3 result-pop';
                } else {
                    result = "Komputer Menang!";
                    kgbCompScore++;
                    kgbCompScoreEl.textContent = kgbCompScore;
                    kgbResultTextEl.className = 'text-2xl font-bold text-red-500 w-1/3 result-pop';
                }

                kgbResultTextEl.textContent = result;
                // Hapus kelas animasi agar bisa dipakai lagi
                setTimeout(() => kgbResultTextEl.classList.remove('result-pop'), 400);
            }

        });
    </script>

</body>
</html>
